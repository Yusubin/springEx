package com.hi.mvc02;


import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;


public class MemberDAO {
//	4媛�吏� 湲곕뒫 �닔�뻾 �쉶�썝媛��엯(create) �쉶�썝�젙蹂�(read) �쉶�썝 �젙蹂� �닔�젙(Update) �쉶�썡 �깉�눜(delete)
	//CRUD �겕猷⑤뱶
	//DAO:Data Access Object �떎�삤
	public void create(MemberVO memberVo) {
		System.out.println("vo�뿉�꽌 �쟾�떖諛쏆� 媛�:"+memberVo);
		
		String id=memberVo.getId();
		String pw=memberVo.getPw();
		String name=memberVo.getName();
		String tel=memberVo.getTel();
		System.out.println("�쟾�떖諛쏆� id:"+id+"�쟾�떖諛쏆� pw:"+pw+"�쟾�떖諛쏆� name:"+name+"�쟾�떖諛쏆� tel:"+tel);
		
		try {
			//1. Connector �씪�씠釉뚮윭由� �꽕�젙
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("1. Connector �씪�씠釉뚮윭由� �꽕�젙 �꽦怨� @@");
			//2. db �뿰寃� �듅�씤�맂 �궗�슜�옄 (ip+port, user(root), pw db紐�(big)) 
			String url = "jdbc:mysql://localhost:3366/big";
			String user ="root";
			String pass = "1234";
			Connection con=DriverManager.getConnection(url, user, pass);
			System.out.println("2. db�뿰寃� �꽦怨� @@");
			//3. SQL�깮�꽦
			String sql="insert into member values (?, ?, ?,? )";
			PreparedStatement ps = con.prepareStatement(sql);
			ps.setString(1, id);
			ps.setString(2, pw);
			ps.setString(3, name);
			ps.setString(4, tel);
			System.out.println("3. SQL媛앹껜�깮�꽦�꽦怨�");
			
			//4. �깮�꽦�븳 sql臾몄쓣 mysql濡� 蹂대궦�떎. 
			ps.executeUpdate();
			System.out.println("4. sql臾몄쓣 mysql濡� 蹂대궦�떎");
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}
	
	public boolean login(MemberVO memberVo) {
		
		String id=memberVo.getId();
		String pw=memberVo.getPw();
	
		try {
			//1. Connector �씪�씠釉뚮윭由� �꽕�젙
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("1. Connector �씪�씠釉뚮윭由� �꽕�젙 �꽦怨� @@");
			//2. db �뿰寃� �듅�씤�맂 �궗�슜�옄 (ip+port, user(root), pw db紐�(big)) 
			String url = "jdbc:mysql://localhost:3366/big";
			String user ="root";
			String pass = "1234";
			Connection con=DriverManager.getConnection(url, user, pass);
			System.out.println("2. db�뿰寃� �꽦怨� @@");
			//3. SQL�깮�꽦
			String sql="SELECT * FROM member where id=? and pw=?";
			PreparedStatement ps = con.prepareStatement(sql);
			ps.setString(1, id);
			ps.setString(2, pw);
			System.out.println("3. SQL媛앹껜�깮�꽦�꽦怨�");
			boolean result=false; //�뾾�쓬 (
			//4. �깮�꽦�븳 sql臾몄쓣 mysql濡� 蹂대궦�떎. 
			ResultSet rs= ps.executeQuery();
			
			if(rs.next()) {
				System.out.println("寃��깋寃곌낵�엳�쓬");
				result=true;
				return result;
			
			}else {
				System.out.println("寃��깋寃곌낵�뾾�쓬");
				
			}
			System.out.println("4. sql臾몄쓣 mysql濡� 蹂대궦�떎");
			
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		System.out.println("�쉶�썝 濡쒓렇�씤");
		return false;
	}
	public MemberVO readOne(MemberVO memberVo) {
		System.out.println("�쉶�썝�젙蹂댁뾽�뜲�씠�듃�슂泥�");
		System.out.println("vo�뿉�꽌 �쟾�떖諛쏆� 媛�:"+memberVo);
		
		String id=memberVo.getId();
	
		try {
			//1. Connector �씪�씠釉뚮윭由� �꽕�젙
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("1. Connector �씪�씠釉뚮윭由� �꽕�젙 �꽦怨� @@");
			//2. db �뿰寃� �듅�씤�맂 �궗�슜�옄 (ip+port, user(root), pw db紐�(big)) 
			String url = "jdbc:mysql://localhost:3366/big";
			String user ="root";
			String pass = "1234";
			Connection con=DriverManager.getConnection(url, user, pass);
			System.out.println("2. db�뿰寃� �꽦怨� @@");
			//3. SQL�깮�꽦
			String sql="SELECT * from member where id=?";
			PreparedStatement ps = con.prepareStatement(sql);
			ps.setString(1, id);
			System.out.println("3. SQL媛앹껜�깮�꽦�꽦怨�");
			
			//4. �깮�꽦�븳 sql臾몄쓣 mysql濡� 蹂대궦�떎. 
			ResultSet rs= ps.executeQuery();
			
//			System.out.println("寃곌낵"+rs.next());
			MemberVO  vo1= new MemberVO();
			if(rs.next()) {
				String id1=rs.getString("id");
				String pw=rs.getString("pw");
				String tel=rs.getString("tel");
				String name=rs.getString("name");
				vo1.setId(id1);
				vo1.setName(name);
				vo1.setPw(pw);
				vo1.setTel(tel);

				return vo1;
			
			}else {
				System.out.println("寃��깋寃곌낵�뾾�쓬");
			}
			System.out.println("4. sql臾몄쓣 mysql濡� 蹂대궦�떎");
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return memberVo;
		
		
		
	}
	public ArrayList<MemberVO> readAll() {
		
		System.out.println("�쉶�썝�젙蹂댁뾽�뜲�씠�듃�슂泥�");
		
		try {
			//1. Connector �씪�씠釉뚮윭由� �꽕�젙
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("1. Connector �씪�씠釉뚮윭由� �꽕�젙 �꽦怨� @@");
			//2. db �뿰寃� �듅�씤�맂 �궗�슜�옄 (ip+port, user(root), pw db紐�(big)) 
			String url = "jdbc:mysql://localhost:3366/big";
			String user ="root";
			String pass = "1234";
			Connection con=DriverManager.getConnection(url, user, pass);
			System.out.println("2. db�뿰寃� �꽦怨� @@");
			//3. SQL�깮�꽦
			String sql="SELECT * from member";
			PreparedStatement ps = con.prepareStatement(sql);
			System.out.println("3. SQL媛앹껜�깮�꽦�꽦怨�");
			
			//4. �깮�꽦�븳 sql臾몄쓣 mysql濡� 蹂대궦�떎. 
			ResultSet rs= ps.executeQuery();
		
			//媛�諛⑸뱾�쓣 紐⑥쓣 ���옣怨듦컙�쓣 留뚮뱾�뼱�빞�븿. 諛곗뿴�� �쟻�빀�븯吏��븡�쓬
			//MemberVO list = new MemberVO[]10()
			//媛�蹂��쟻�씤 怨듦컙�씠 �븘�슂
			ArrayList<MemberVO> list = new ArrayList<>();
			
			
			while(rs.next()) {
				MemberVO  vo1= new MemberVO();
				String id1=rs.getString("id");
				String pw=rs.getString("pw");
				String tel=rs.getString("tel");
				String name=rs.getString("name");
				
				//媛�諛⑹뿉 �꽔�쓬
				vo1.setId(id1);
				vo1.setName(name);
				vo1.setPw(pw);
				vo1.setTel(tel);
				
				list.add(vo1);
				
			}
			System.out.println("4. sql臾몄쓣 mysql濡� 蹂대궦�떎");
			return list;
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;
	

		
		
		
		
		
	}
	public void update(MemberVO memberVo) {
		System.out.println("�쉶�썝�젙蹂댁뾽�뜲�씠�듃�슂泥�");
		System.out.println("vo�뿉�꽌 �쟾�떖諛쏆� 媛�:"+memberVo);
		
		String id=memberVo.getId();
		String pw=memberVo.getPw();
		String name=memberVo.getName();
		String tel=memberVo.getTel();
		try {
			//1. Connector �씪�씠釉뚮윭由� �꽕�젙
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("1. Connector �씪�씠釉뚮윭由� �꽕�젙 �꽦怨� @@");
			//2. db �뿰寃� �듅�씤�맂 �궗�슜�옄 (ip+port, user(root), pw db紐�(big)) 
			String url = "jdbc:mysql://localhost:3366/big";
			String user ="root";
			String pass = "1234";
			Connection con=DriverManager.getConnection(url, user, pass);
			System.out.println("2. db�뿰寃� �꽦怨� @@");
			//3. SQL�깮�꽦
			String sql="UPDATE member set tel=?  where id=?";
			PreparedStatement ps = con.prepareStatement(sql);
			ps.setString(1, tel);
			ps.setString(2, id);
			System.out.println("3. SQL媛앹껜�깮�꽦�꽦怨�");
			
			//4. �깮�꽦�븳 sql臾몄쓣 mysql濡� 蹂대궦�떎. 
			ps.executeUpdate();
			System.out.println("4. sql臾몄쓣 mysql濡� 蹂대궦�떎");
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	public void delete(MemberVO memberVo) {
		System.out.println("�쉶�썝�젙蹂� �궘�젣");
		String id=memberVo.getId();

		try {
			//1. Connector �씪�씠釉뚮윭由� �꽕�젙
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("1. Connector �씪�씠釉뚮윭由� �꽕�젙 �꽦怨� @@");
			//2. db �뿰寃� �듅�씤�맂 �궗�슜�옄 (ip+port, user(root), pw db紐�(big)) 
			String url = "jdbc:mysql://localhost:3366/big";
			String user ="root";
			String pass = "1234";
			Connection con=DriverManager.getConnection(url, user, pass);
			System.out.println("2. db�뿰寃� �꽦怨� @@");
			//3. SQL�깮�꽦
			String sql="DELETE FROM member  where id=?";
			PreparedStatement ps = con.prepareStatement(sql);
			ps.setString(1, id);
			System.out.println("3. SQL媛앹껜�깮�꽦�꽦怨�");
			
			//4. �깮�꽦�븳 sql臾몄쓣 mysql濡� 蹂대궦�떎. 
			ps.executeUpdate();
			System.out.println("4. sql臾몄쓣 mysql濡� 蹂대궦�떎");
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	
}
